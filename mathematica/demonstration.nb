(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     27455,        733]
NotebookOptionsPosition[     25192,        656]
NotebookOutlinePosition[     25546,        672]
CellTagsIndexPosition[     25503,        669]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.676904742459731*^9, 3.6769047482095823`*^9}, {
  3.676904862202697*^9, 3.6769048717187357`*^9}}],

Cell[BoxData[
 RowBox[{"<<", "mimir.wl"}]], "Input",
 CellChangeTimes->{{3.6769048741633387`*^9, 3.676904939735599*^9}, {
  3.677051162145059*^9, 3.6770511677278214`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xIris", "=", 
   RowBox[{"addBiasTerm", "[", 
    RowBox[{"iris", "[", "\"\<x\>\"", "]"}], "]"}]}], ";", 
  RowBox[{"yIris", "=", 
   RowBox[{"binarize", "[", 
    RowBox[{"iris", "[", "\"\<y\>\"", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6768756477050047`*^9, 3.6768756805420313`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"split", "=", 
  RowBox[{"stratifiedSample", "[", "yIris", "]"}]}]], "Input",
 CellChangeTimes->{{3.676875684175716*^9, 3.676875693301116*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "22", ",", "4", ",", "3", ",", "6", ",", "27", ",", "46", ",", "30", ",", 
     "19", ",", "14", ",", "11", ",", "1", ",", "34", ",", "39", ",", "48", 
     ",", "42", ",", "18", ",", "41", ",", "49", ",", "38", ",", "16", ",", 
     "44", ",", "10", ",", "15", ",", "45", ",", "31", ",", "8", ",", "21", 
     ",", "35", ",", "33", ",", "36", ",", "25", ",", "29", ",", "37", ",", 
     "2", ",", "26", ",", "50", ",", "28", ",", "32", ",", "24", ",", "9", 
     ",", "64", ",", "77", ",", "96", ",", "60", ",", "94", ",", "55", ",", 
     "62", ",", "97", ",", "67", ",", "80", ",", "76", ",", "72", ",", "63", 
     ",", "91", ",", "79", ",", "75", ",", "74", ",", "52", ",", "95", ",", 
     "57", ",", "85", ",", "68", ",", "93", ",", "88", ",", "83", ",", "78", 
     ",", "92", ",", "81", ",", "89", ",", "90", ",", "98", ",", "86", ",", 
     "69", ",", "84", ",", "71", ",", "54", ",", "53", ",", "87", ",", "56", 
     ",", "70", ",", "133", ",", "114", ",", "136", ",", "103", ",", "109", 
     ",", "122", ",", "146", ",", "141", ",", "125", ",", "108", ",", "147", 
     ",", "105", ",", "130", ",", "140", ",", "110", ",", "118", ",", "121", 
     ",", "142", ",", "101", ",", "111", ",", "139", ",", "132", ",", "123", 
     ",", "116", ",", "113", ",", "112", ",", "120", ",", "117", ",", "134", 
     ",", "145", ",", "150", ",", "148", ",", "128", ",", "137", ",", "124", 
     ",", "144", ",", "106", ",", "143", ",", "115", ",", "127"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5", ",", "7", ",", "12", ",", "13", ",", "17", ",", "20", ",", "23", ",",
      "40", ",", "43", ",", "47", ",", "51", ",", "58", ",", "59", ",", "61", 
     ",", "65", ",", "66", ",", "73", ",", "82", ",", "99", ",", "100", ",", 
     "102", ",", "104", ",", "107", ",", "119", ",", "126", ",", "129", ",", 
     "131", ",", "135", ",", "138", ",", "149"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.676875693877009*^9, 3.676889122627387*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"split", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "13", ",", "40", ",", "24", ",", "6", ",", "4", ",", "30", ",", "50", 
      ",", "48", ",", "22", ",", "31", ",", "35", ",", "49", ",", "21", ",", 
      "46", ",", "32", ",", "28", ",", "18", ",", "23", ",", "42", ",", "7", 
      ",", "41", ",", "39", ",", "43", ",", "20", ",", "27", ",", "16", ",", 
      "36", ",", "11", ",", "47", ",", "26", ",", "1", ",", "33", ",", "2", 
      ",", "17", ",", "5", ",", "14", ",", "25", ",", "34", ",", "44", ",", 
      "19", ",", "82", ",", "66", ",", "63", ",", "51", ",", "94", ",", "93", 
      ",", "54", ",", "59", ",", "88", ",", "56", ",", "71", ",", "73", ",", 
      "84", ",", "57", ",", "53", ",", "74", ",", "79", ",", "65", ",", "69", 
      ",", "60", ",", "75", ",", "90", ",", "68", ",", "52", ",", "67", ",", 
      "99", ",", "91", ",", "70", ",", "96", ",", "64", ",", "83", ",", "55", 
      ",", "87", ",", "86", ",", "97", ",", "98", ",", "80", ",", "72", ",", 
      "95", ",", "81", ",", "143", ",", "148", ",", "126", ",", "146", ",", 
      "120", ",", "102", ",", "142", ",", "106", ",", "130", ",", "139", ",", 
      "123", ",", "121", ",", "140", ",", "125", ",", "135", ",", "112", ",", 
      "149", ",", "118", ",", "133", ",", "134", ",", "105", ",", "131", ",", 
      "129", ",", "116", ",", "128", ",", "132", ",", "137", ",", "113", ",", 
      "108", ",", "144", ",", "150", ",", "107", ",", "110", ",", "109", ",", 
      "103", ",", "101", ",", "127", ",", "104", ",", "147", ",", "114"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "3", ",", "8", ",", "9", ",", "10", ",", "12", ",", "15", ",", "29", ",",
       "37", ",", "38", ",", "45", ",", "58", ",", "61", ",", "62", ",", "76",
       ",", "77", ",", "78", ",", "85", ",", "89", ",", "92", ",", "100", ",",
       "111", ",", "115", ",", "117", ",", "119", ",", "122", ",", "124", ",",
       "136", ",", "138", ",", "141", ",", "145"}], "}"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "13", ",", "40", ",", "24", ",", "6", ",", "4", ",", "30", ",", "50", ",",
      "48", ",", "22", ",", "31", ",", "35", ",", "49", ",", "21", ",", "46", 
     ",", "32", ",", "28", ",", "18", ",", "23", ",", "42", ",", "7", ",", 
     "41", ",", "39", ",", "43", ",", "20", ",", "27", ",", "16", ",", "36", 
     ",", "11", ",", "47", ",", "26", ",", "1", ",", "33", ",", "2", ",", 
     "17", ",", "5", ",", "14", ",", "25", ",", "34", ",", "44", ",", "19", 
     ",", "82", ",", "66", ",", "63", ",", "51", ",", "94", ",", "93", ",", 
     "54", ",", "59", ",", "88", ",", "56", ",", "71", ",", "73", ",", "84", 
     ",", "57", ",", "53", ",", "74", ",", "79", ",", "65", ",", "69", ",", 
     "60", ",", "75", ",", "90", ",", "68", ",", "52", ",", "67", ",", "99", 
     ",", "91", ",", "70", ",", "96", ",", "64", ",", "83", ",", "55", ",", 
     "87", ",", "86", ",", "97", ",", "98", ",", "80", ",", "72", ",", "95", 
     ",", "81", ",", "143", ",", "148", ",", "126", ",", "146", ",", "120", 
     ",", "102", ",", "142", ",", "106", ",", "130", ",", "139", ",", "123", 
     ",", "121", ",", "140", ",", "125", ",", "135", ",", "112", ",", "149", 
     ",", "118", ",", "133", ",", "134", ",", "105", ",", "131", ",", "129", 
     ",", "116", ",", "128", ",", "132", ",", "137", ",", "113", ",", "108", 
     ",", "144", ",", "150", ",", "107", ",", "110", ",", "109", ",", "103", 
     ",", "101", ",", "127", ",", "104", ",", "147", ",", "114"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3", ",", "8", ",", "9", ",", "10", ",", "12", ",", "15", ",", "29", ",", 
     "37", ",", "38", ",", "45", ",", "58", ",", "61", ",", "62", ",", "76", 
     ",", "77", ",", "78", ",", "85", ",", "89", ",", "92", ",", "100", ",", 
     "111", ",", "115", ",", "117", ",", "119", ",", "122", ",", "124", ",", 
     "136", ",", "138", ",", "141", ",", "145"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.67688917209976*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xIrisTrain", "=", 
   RowBox[{"xIris", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"split", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ",", "All"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yIrisTrain", "=", 
   RowBox[{"yIris", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"split", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ",", "All"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xIrisTest", "=", 
   RowBox[{"xIris", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"split", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", "All"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yIrisTest", "=", 
   RowBox[{"yIris", "\[LeftDoubleBracket]", 
    RowBox[{
     RowBox[{"split", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ",", "All"}], "\[RightDoubleBracket]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.676875697418343*^9, 3.676875769574485*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m", "=", 
  RowBox[{"mimir`ovr`train", "[", 
   RowBox[{
    RowBox[{"ovrClassifier", "[", 
     RowBox[{"mimir`logistic`train", ",", "mimir`logistic`logprob"}], "]"}], 
    ",", "xIrisTrain", ",", "yIrisTrain"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.676875794563406*^9, 3.676875841536027*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0.695018044764844`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.676889175384192*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "0.17515818017354956`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.676889175390834*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "0.08519150307178579`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.676889175399515*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "0.05528856644528667`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.676889175408478*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "0.04647007593168234`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.6768891754170647`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "0.045141144678485574`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.676889175425662*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7", ",", "0.04509722529763667`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.6768891754344397`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0.693149760307517`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.676889175443041*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "0.5318649362902514`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.676889175451692*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "0.5244217007268145`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.676889175460699*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "0.524297362564145`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.67688917546938*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0.6928897983290943`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.6768891754799337`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "0.33123876582953526`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.6768891754904957`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "0.25214743617354635`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.6768891755009336`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "0.19943411420978163`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.676889175511609*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "0.17405308901259908`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.676889175522154*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "0.17200837530051086`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.676889175532476*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7", ",", "0.17198806504374495`"}], "}"}]], "Print",
 CellChangeTimes->{3.676875842202231*^9, 3.676889133642063*^9, 
  3.676889175545985*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"trainFunc\"\>", "\[Rule]", "mimir`logistic`train"}], ",", 
   RowBox[{"\<\"logProbFunc\"\>", "\[Rule]", "logprob"}], ",", 
   RowBox[{"\<\"models\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"logistic\"\>"}], ",", 
        RowBox[{"\<\"\[Lambda]\"\>", "\[Rule]", "1.`"}], ",", 
        RowBox[{"\<\"iterations\"\>", "\[Rule]", "50"}], ",", 
        RowBox[{"\<\"\[Theta]\"\>", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"6.863853924542842`", ",", 
           RowBox[{"-", "0.48471724772516667`"}], ",", "0.8103864205249693`", 
           ",", 
           RowBox[{"-", "2.2096494074622584`"}], ",", 
           RowBox[{"-", "0.918589859736256`"}]}], "}"}]}], ",", 
        RowBox[{"\<\"stats\"\>", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0.695018044764844`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "0.17515818017354956`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "0.08519150307178579`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "0.05528856644528667`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "0.04647007593168234`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"6", ",", "0.045141144678485574`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "0.04509722529763667`"}], "}"}]}], "}"}]}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"logistic\"\>"}], ",", 
        RowBox[{"\<\"\[Lambda]\"\>", "\[Rule]", "1.`"}], ",", 
        RowBox[{"\<\"iterations\"\>", "\[Rule]", "50"}], ",", 
        RowBox[{"\<\"\[Theta]\"\>", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"4.863356353550439`", ",", 
           RowBox[{"-", "0.04357740527243651`"}], ",", 
           RowBox[{"-", "2.0495769699478195`"}], ",", "0.5304408255000165`", 
           ",", 
           RowBox[{"-", "1.0151030242148265`"}]}], "}"}]}], ",", 
        RowBox[{"\<\"stats\"\>", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0.693149760307517`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "0.5318649362902514`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "0.5244217007268145`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "0.524297362564145`"}], "}"}]}], "}"}]}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"logistic\"\>"}], ",", 
        RowBox[{"\<\"\[Lambda]\"\>", "\[Rule]", "1.`"}], ",", 
        RowBox[{"\<\"iterations\"\>", "\[Rule]", "50"}], ",", 
        RowBox[{"\<\"\[Theta]\"\>", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "13.983531293682928`"}], ",", 
           RowBox[{"-", "0.27009629808154484`"}], ",", 
           RowBox[{"-", "0.4469948014597057`"}], ",", "2.7409624451554953`", 
           ",", "2.140160227461514`"}], "}"}]}], ",", 
        RowBox[{"\<\"stats\"\>", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0.6928897983290943`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "0.33123876582953526`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "0.25214743617354635`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "0.19943411420978163`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "0.17405308901259908`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"6", ",", "0.17200837530051086`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "0.17198806504374495`"}], "}"}]}], "}"}]}]}], 
       "}"}]}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.676875842253151*^9, 3.676889133886982*^9, 
  3.676889175558845*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pred", "=", 
  RowBox[{"mimir`data`binarize", "[", 
   RowBox[{"mimir`ovr`predict", "[", 
    RowBox[{"m", ",", "xIrisTest"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.676875844736948*^9, 3.676875868474826*^9}, {
  3.676875940512156*^9, 3.676875964597795*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6768758450958347`*^9, 3.6768758689891653`*^9}, {
   3.6768759458492403`*^9, 3.676875965171822*^9}, 3.6768891377485237`*^9, 
   3.676889177652425*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mimir`metrics`accuracy", "[", 
  RowBox[{"yIrisTest", ",", "pred"}], "]"}]], "Input",
 CellChangeTimes->{{3.676876251287649*^9, 3.676876274973827*^9}}],

Cell[BoxData["0.9666666666666667`"], "Output",
 CellChangeTimes->{3.676876275953949*^9, 3.6768891455361853`*^9, 
  3.67688918080162*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"m", "=", 
  RowBox[{"mimir`maxent`train", "[", 
   RowBox[{"xIrisTrain", ",", "yIrisTrain", ",", "1.0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.677153753496663*^9, 3.677153789553432*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1.0993505654575628`"}], "}"}]], "Print",
 CellChangeTimes->{3.677153790264195*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "0.49813223814027763`"}], "}"}]], "Print",
 CellChangeTimes->{3.6771537902682743`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "0.3678305760996927`"}], "}"}]], "Print",
 CellChangeTimes->{3.677153790297914*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "0.3007110172497989`"}], "}"}]], "Print",
 CellChangeTimes->{3.6771537903206377`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "0.29128921421380827`"}], "}"}]], "Print",
 CellChangeTimes->{3.677153790323141*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "0.2909879505432295`"}], "}"}]], "Print",
 CellChangeTimes->{3.677153790325831*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"type\"\>", "\[Rule]", "\<\"maxent\"\>"}], ",", 
   RowBox[{"\<\"\[Lambda]\"\>", "\[Rule]", "1.`"}], ",", 
   RowBox[{"\<\"iterations\"\>", "\[Rule]", "50"}], ",", 
   RowBox[{"\<\"\[Theta]\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"17.177619218986823`", ",", 
        RowBox[{"-", "0.8226440321513355`"}], ",", "1.1023520686843202`", ",", 
        RowBox[{"-", "3.5890805062460807`"}], ",", 
        RowBox[{"-", "1.5184655160924996`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"11.096650337714351`", ",", "0.19069990955220273`", ",", 
        RowBox[{"-", "0.351596704775938`"}], ",", 
        RowBox[{"-", "1.7038320238661109`"}], ",", 
        RowBox[{"-", "1.7822523084166053`"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"stats\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1.0993505654575628`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "0.49813223814027763`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "0.3678305760996927`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "0.3007110172497989`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "0.29128921421380827`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "0.2909879505432295`"}], "}"}]}], "}"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.677153790328683*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pred", "=", 
  RowBox[{"mimir`data`binarize", "[", 
   RowBox[{"mimir`maxent`predict", "[", 
    RowBox[{"m", ",", "xIrisTest"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6771537932872057`*^9, 3.677153844330681*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.677153816874194*^9, 3.677153845024024*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mimir`metrics`accuracy", "[", 
  RowBox[{"yIrisTest", ",", "pred"}], "]"}]], "Input",
 CellChangeTimes->{{3.6771538484292793`*^9, 3.677153862880739*^9}}],

Cell[BoxData["0.9666666666666667`"], "Output",
 CellChangeTimes->{3.677153863492318*^9}]
}, Open  ]]
},
WindowSize->{973, 1005},
WindowMargins->{{105, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 6, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 242, 5, 28, "Input"],
Cell[803, 27, 171, 3, 28, "Input"],
Cell[977, 32, 335, 8, 28, "Input"],
Cell[CellGroupData[{
Cell[1337, 44, 166, 3, 28, "Input"],
Cell[1506, 49, 2029, 31, 131, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3572, 85, 2026, 32, 131, "Input"],
Cell[5601, 119, 2006, 31, 131, "Output"]
}, Open  ]],
Cell[7622, 153, 1098, 28, 80, "Input"],
Cell[CellGroupData[{
Cell[8745, 185, 322, 7, 28, "Input"],
Cell[CellGroupData[{
Cell[9092, 196, 178, 4, 21, "Print"],
Cell[9273, 202, 180, 4, 21, "Print"],
Cell[9456, 208, 180, 4, 21, "Print"],
Cell[9639, 214, 180, 4, 21, "Print"],
Cell[9822, 220, 182, 4, 21, "Print"],
Cell[10007, 226, 181, 4, 21, "Print"],
Cell[10191, 232, 182, 4, 21, "Print"],
Cell[10376, 238, 178, 4, 21, "Print"],
Cell[10557, 244, 179, 4, 21, "Print"],
Cell[10739, 250, 179, 4, 21, "Print"],
Cell[10921, 256, 177, 4, 21, "Print"],
Cell[11101, 262, 181, 4, 21, "Print"],
Cell[11285, 268, 182, 4, 21, "Print"],
Cell[11470, 274, 182, 4, 21, "Print"],
Cell[11655, 280, 180, 4, 21, "Print"],
Cell[11838, 286, 180, 4, 21, "Print"],
Cell[12021, 292, 180, 4, 21, "Print"],
Cell[12204, 298, 180, 4, 21, "Print"]
}, Open  ]],
Cell[12399, 305, 4094, 93, 148, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16530, 403, 291, 6, 28, "Input"],
Cell[16824, 411, 2475, 65, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19336, 481, 175, 3, 28, "Input"],
Cell[19514, 486, 136, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19687, 493, 214, 4, 28, "Input"],
Cell[CellGroupData[{
Cell[19926, 501, 132, 3, 21, "Print"],
Cell[20061, 506, 135, 3, 21, "Print"],
Cell[20199, 511, 132, 3, 21, "Print"],
Cell[20334, 516, 134, 3, 21, "Print"],
Cell[20471, 521, 133, 3, 21, "Print"],
Cell[20607, 526, 132, 3, 21, "Print"]
}, Open  ]],
Cell[20754, 532, 1461, 35, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22252, 572, 247, 5, 28, "Input"],
Cell[22502, 579, 2369, 63, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24908, 647, 177, 3, 28, "Input"],
Cell[25088, 652, 88, 1, 62, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
